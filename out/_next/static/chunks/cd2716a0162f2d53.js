(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31713,e=>{"use strict";var t=e.i(43476),n=e.i(71645);let r="new valentine",l=Array.from({length:60},(e,t)=>{let n=t%2;return"<3".repeat(Math.ceil((160+n)/2)).slice(n,n+160)}),i=[];for(let e=0;e<60;e++){let t=l[e];for(let n=0;n<159;n++)"<"===t[n]&&"3"===t[n+1]&&i.push([e,n])}let o=(0,n.memo)(function(){return(0,t.jsx)(t.Fragment,{children:l.map((e,n)=>(0,t.jsx)("div",{style:{whiteSpace:"pre"},children:e.split("").map((e,n)=>(0,t.jsx)("span",{style:{opacity:0,color:"#E57FA9",transition:"opacity 1s ease-in-out"},children:e},n))},n))})});function a(){let[e,a]=(0,n.useState)([]),[s,h]=(0,n.useState)(null),[c,u]=(0,n.useState)(null),[f,d]=(0,n.useState)(null),p=(0,n.useRef)(null),g=(0,n.useRef)(new Set),m=(0,n.useRef)(new Set),w=(0,n.useMemo)(()=>s?function(e,t){let n=e.split(" "),r=[],l="";for(let e of n)l&&l.length+1+e.length>36?(r.push(l),l=e):l=l?l+" "+e:e;return l&&r.push(l),r}(s.message,0):[],[s]);(0,n.useEffect)(()=>{fetch("/valentines.json").then(e=>e.json()).then(e=>{a(e),e.length>0&&h(e[Math.floor(Math.random()*e.length)])})},[]),(0,n.useEffect)(()=>{if(c)return;let e=p.current;if(!e)return;let t=e.children[0],n=t?.children[0];t&&n&&u({charWidth:n.getBoundingClientRect().width,lineHeight:t.getBoundingClientRect().height})});let y=(0,n.useCallback)(()=>{if(!c||0===w.length)return;let e=function(e,t,n){let l=Math.floor(window.innerWidth/2/t),i=Math.floor(Math.floor(window.innerHeight/2/n)-e.length/2),o=new Set;for(let t=0;t<e.length;t++){let n=Math.floor(l-e[t].length/2);for(let r=0;r<e[t].length;r++){let e=i+t,l=n+r;e>=0&&e<60&&l>=0&&l<160&&o.add(`${e}-${l}`)}}let a=Math.min(Math.floor(window.innerHeight/n)-5,59),s=r.length+2,h=Math.floor(l-s/2);if(a>=0&&a<60)for(let e=0;e<s;e++){let t=h+e;t>=0&&t<160&&o.add(`${a}-${t}`)}return{startRow:i,centerCol:l,messageCells:o,top:i*n,buttonRow:a,buttonStartCol:h}}(w,c.charWidth,c.lineHeight),t=p.current;if(t){for(let n of g.current)if(e.messageCells.has(n)){let[e,r]=n.split("-").map(Number),l=t.children[e]?.children[r];l&&(l.style.opacity="0")}for(let t of e.messageCells)g.current.delete(t)}m.current=e.messageCells,d({top:e.top,startRow:e.startRow,centerCol:e.centerCol,buttonRow:e.buttonRow,buttonStartCol:e.buttonStartCol})},[c,w]);return(0,n.useEffect)(()=>{y()},[y]),(0,n.useEffect)(()=>{if(!c)return;let e=()=>y();return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[c,y]),(0,n.useEffect)(()=>{let e=p.current;if(e)for(let t of g.current){let[n,r]=t.split("-").map(Number),l=e.children[n]?.children[r];l&&(l.style.opacity="0")}g.current=new Set},[s]),(0,n.useEffect)(()=>{let e=p.current;if(!e||!c)return;let{charWidth:t,lineHeight:n}=c,r=r=>{let l=e.getBoundingClientRect(),i=r.clientX-l.left,o=r.clientY-l.top,a=Math.max(0,Math.floor((i-12)/t)),s=Math.min(159,Math.ceil((i+12)/t)),h=Math.max(0,Math.floor((o-12)/n)),c=Math.min(59,Math.ceil((o+12)/n)),u=new Set;for(let e=h;e<=c;e++)for(let r=a;r<=s;r++){let l=`${e}-${r}`;!m.current.has(l)&&12>=Math.sqrt((i-(r*t+t/2))**2+(o-(e*n+n/2))**2)&&u.add(l)}for(let t of g.current)if(!u.has(t)){let[n,r]=t.split("-").map(Number),l=e.children[n]?.children[r];l&&(l.style.transition="none",l.style.opacity="0")}for(let t of u)if(!g.current.has(t)){let[n,r]=t.split("-").map(Number),l=e.children[n]?.children[r];l&&(l.style.transition="none",l.style.opacity="1")}g.current=u};return window.addEventListener("mousemove",r),()=>window.removeEventListener("mousemove",r)},[c]),(0,n.useEffect)(()=>{let e=p.current;if(!e||!c)return;let{charWidth:t,lineHeight:n}=c,r=Math.floor(window.innerWidth/t),l=Math.floor(window.innerHeight/n),o=i.filter(([e,t])=>e<l&&t<r),a=setInterval(()=>{let[t,n]=o[Math.floor(Math.random()*o.length)],r=`${t}-${n}`,l=`${t}-${n+1}`;if(m.current.has(r)||m.current.has(l)||g.current.has(r)||g.current.has(l))return;let i=e.children[t];if(!i)return;let a=i.children[n],s=i.children[n+1];a&&s&&(a.style.transition="opacity 1s ease-in-out",s.style.transition="opacity 1s ease-in-out",a.style.opacity="0.7",s.style.opacity="0.7",setTimeout(()=>{g.current.has(r)||(a.style.opacity="0"),g.current.has(l)||(s.style.opacity="0")},1500))},2500/Math.max(1,Math.floor(.002*o.length)));return()=>clearInterval(a)},[c]),(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{ref:p,className:"fixed inset-0 overflow-hidden select-none pointer-events-none",style:{lineHeight:"1.2",backgroundImage:"radial-gradient(ellipse 400px 250px at center, #ffd0b090 0%, transparent 100%)"},children:[(0,t.jsx)(o,{}),c&&f&&w.length>0&&(0,t.jsx)("div",{style:{position:"absolute",top:f.top,left:0,right:0,lineHeight:"1.2",whiteSpace:"pre"},children:w.map((e,n)=>{let r=Math.floor(f.centerCol-e.length/2);return(0,t.jsxs)("div",{style:{whiteSpace:"pre"},children:[(0,t.jsx)("span",{style:{visibility:"hidden"},children:l[f.startRow+n]?.slice(0,r)??""}),e]},n)})}),c&&f&&s&&(0,t.jsx)("button",{onClick:()=>{let t;if(0!==e.length){do t=e[Math.floor(Math.random()*e.length)];while(e.length>1&&t.id===s?.id)h(t)}},className:"pointer-events-auto border-2 border-current rounded-lg bg-transparent hover:-translate-y-0.5 hover:bg-[#FFCFB0] transition-all duration-200",style:{position:"absolute",top:f.buttonRow*c.lineHeight-8,left:f.buttonStartCol*c.charWidth+3,padding:"6px 10px",lineHeight:"1.2",whiteSpace:"pre",cursor:"pointer",float:"left"},children:r})]})})}e.s(["default",()=>a])}]);
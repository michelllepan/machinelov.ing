(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31713,e=>{"use strict";var t=e.i(43476),n=e.i(71645);let r="new valentine",l=Array.from({length:60},(e,t)=>{let n=t%2;return"<3".repeat(Math.ceil((160+n)/2)).slice(n,n+160)}),i=[];for(let e=0;e<60;e++){let t=l[e];for(let n=0;n<159;n++)"<"===t[n]&&"3"===t[n+1]&&i.push([e,n])}let o=(0,n.memo)(function(){return(0,t.jsx)(t.Fragment,{children:l.map((e,n)=>(0,t.jsx)("div",{style:{whiteSpace:"pre"},children:e.split("").map((e,n)=>(0,t.jsx)("span",{style:{opacity:0,color:"#E57FA9",transition:"opacity 1s ease-in-out"},children:e},n))},n))})});function a(){var e;let[a,s]=(0,n.useState)([]),[h,c]=(0,n.useState)(null),[u,f]=(0,n.useState)(null),[d,p]=(0,n.useState)(null),g=(0,n.useRef)(null),m=(0,n.useRef)(new Set),w=(0,n.useRef)(new Set),y=u?(e=u.charWidth,Math.max(16,Math.min(36,Math.floor(window.innerWidth/e)-4))):36,M=(0,n.useMemo)(()=>h?function(e,t){let n=e.split(" "),r=[],l="";for(let e of n)l&&l.length+1+e.length>t?(r.push(l),l=e):l=l?l+" "+e:e;return l&&r.push(l),r}(h.message,y):[],[h,y]);(0,n.useEffect)(()=>{fetch("/valentines.json").then(e=>e.json()).then(e=>{s(e),e.length>0&&c(e[Math.floor(Math.random()*e.length)])})},[]),(0,n.useEffect)(()=>{if(u)return;let e=g.current;if(!e)return;let t=e.children[0],n=t?.children[0];t&&n&&f({charWidth:n.getBoundingClientRect().width,lineHeight:t.getBoundingClientRect().height})});let v=(0,n.useCallback)(()=>{if(!u||0===M.length)return;let e=function(e,t,n){let l=Math.floor(window.innerWidth/2/t),i=Math.floor(Math.floor(window.innerHeight/2/n)-e.length/2),o=new Set;for(let t=0;t<e.length;t++){let n=Math.floor(l-e[t].length/2);for(let r=0;r<e[t].length;r++){let e=i+t,l=n+r;e>=0&&e<60&&l>=0&&l<160&&o.add(`${e}-${l}`)}}let a=Math.min(Math.floor(window.innerHeight/n)-5,59),s=r.length+2,h=Math.floor(l-s/2);if(a>=0&&a<60)for(let e=0;e<s;e++){let t=h+e;t>=0&&t<160&&o.add(`${a}-${t}`)}return{startRow:i,centerCol:l,messageCells:o,top:i*n,buttonRow:a,buttonStartCol:h}}(M,u.charWidth,u.lineHeight),t=g.current;if(t){for(let n of m.current)if(e.messageCells.has(n)){let[e,r]=n.split("-").map(Number),l=t.children[e]?.children[r];l&&(l.style.opacity="0")}for(let t of e.messageCells)m.current.delete(t)}w.current=e.messageCells,p({top:e.top,startRow:e.startRow,centerCol:e.centerCol,buttonRow:e.buttonRow,buttonStartCol:e.buttonStartCol})},[u,M]);return(0,n.useEffect)(()=>{v()},[v]),(0,n.useEffect)(()=>{if(!u)return;let e=()=>v();return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[u,v]),(0,n.useEffect)(()=>{let e=g.current;if(e)for(let t of m.current){let[n,r]=t.split("-").map(Number),l=e.children[n]?.children[r];l&&(l.style.opacity="0")}m.current=new Set},[h]),(0,n.useEffect)(()=>{let e=g.current;if(!e||!u)return;let{charWidth:t,lineHeight:n}=u,r=r=>{let l=e.getBoundingClientRect(),i=r.clientX-l.left,o=r.clientY-l.top,a=Math.max(0,Math.floor((i-12)/t)),s=Math.min(159,Math.ceil((i+12)/t)),h=Math.max(0,Math.floor((o-12)/n)),c=Math.min(59,Math.ceil((o+12)/n)),u=new Set;for(let e=h;e<=c;e++)for(let r=a;r<=s;r++){let l=`${e}-${r}`;!w.current.has(l)&&12>=Math.sqrt((i-(r*t+t/2))**2+(o-(e*n+n/2))**2)&&u.add(l)}for(let t of m.current)if(!u.has(t)){let[n,r]=t.split("-").map(Number),l=e.children[n]?.children[r];l&&(l.style.transition="none",l.style.opacity="0")}for(let t of u)if(!m.current.has(t)){let[n,r]=t.split("-").map(Number),l=e.children[n]?.children[r];l&&(l.style.transition="none",l.style.opacity="1")}m.current=u};return window.addEventListener("mousemove",r),()=>window.removeEventListener("mousemove",r)},[u]),(0,n.useEffect)(()=>{let e=g.current;if(!e||!u)return;let{charWidth:t,lineHeight:n}=u,r=Math.floor(window.innerWidth/t),l=Math.floor(window.innerHeight/n),o=i.filter(([e,t])=>e<l&&t<r),a=setInterval(()=>{let[t,n]=o[Math.floor(Math.random()*o.length)],r=`${t}-${n}`,l=`${t}-${n+1}`;if(w.current.has(r)||w.current.has(l)||m.current.has(r)||m.current.has(l))return;let i=e.children[t];if(!i)return;let a=i.children[n],s=i.children[n+1];a&&s&&(a.style.transition="opacity 1s ease-in-out",s.style.transition="opacity 1s ease-in-out",a.style.opacity="0.7",s.style.opacity="0.7",setTimeout(()=>{m.current.has(r)||(a.style.opacity="0"),m.current.has(l)||(s.style.opacity="0")},1500))},2500/Math.max(1,Math.floor(.002*o.length)));return()=>clearInterval(a)},[u]),(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{ref:g,className:"fixed inset-0 overflow-hidden select-none pointer-events-none",style:{lineHeight:"1.2",backgroundImage:"radial-gradient(ellipse 400px 250px at center, #ffd0b090 0%, transparent 100%)"},children:[(0,t.jsx)(o,{}),u&&d&&M.length>0&&(0,t.jsx)("div",{style:{position:"absolute",top:d.top,left:0,right:0,lineHeight:"1.2",whiteSpace:"pre"},children:M.map((e,n)=>{let r=Math.max(0,Math.floor(d.centerCol-e.length/2));return(0,t.jsxs)("div",{style:{whiteSpace:"pre"},children:[(0,t.jsx)("span",{style:{visibility:"hidden"},children:l[d.startRow+n]?.slice(0,r)??""}),e]},n)})}),u&&d&&h&&(0,t.jsx)("button",{onClick:()=>{let e;if(0!==a.length){do e=a[Math.floor(Math.random()*a.length)];while(a.length>1&&e.id===h?.id)c(e)}},className:"pointer-events-auto border-2 border-current rounded-lg bg-transparent hover:-translate-y-0.5 hover:bg-[#FFCFB0] transition-all duration-200",style:{position:"absolute",top:d.buttonRow*u.lineHeight-8,left:d.buttonStartCol*u.charWidth+3,padding:"6px 10px",lineHeight:"1.2",whiteSpace:"pre",cursor:"pointer",float:"left"},children:r})]})})}e.s(["default",()=>a])}]);